<!doctype html>
<html data-n-head-ssr>
  <head>
    <title>Nuxtpress - Node.js 动态网站静态化之路 - 初瘦</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="想当初，也瘦过。"><link data-n-head="ssr" rel="shortcut icon" href="/favicon.png"><link rel="preload" href="/_nuxt/b62c614e63f83c6be00e.js" as="script"><link rel="preload" href="/_nuxt/6f82558aa98d932751d3.js" as="script"><link rel="preload" href="/_nuxt/eb79ce08f01f586d0643.css" as="style"><link rel="preload" href="/_nuxt/1adc803c9f70786e1780.js" as="script"><link rel="preload" href="/_nuxt/decfb81475ec337adc7b.css" as="style"><link rel="preload" href="/_nuxt/e11a89e73901e5a987e8.js" as="script"><link rel="stylesheet" href="/_nuxt/eb79ce08f01f586d0643.css"><link rel="stylesheet" href="/_nuxt/decfb81475ec337adc7b.css">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><aside id="sidebar"><div class="table"><div class="table-cell"><div class="logo"><a href="/" class="nuxt-link-active"><img src="/avatar.png" class="avatar"></a> <h1 style="display:none"><a href="/" class="nuxt-link-active">
            初瘦
          </a></h1> <h2>想当初，也瘦过。</h2></div> <nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">
        15
      </span> <span class="site-state-item-name">日志</span></a></div> <div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">
        3
      </span> <span class="site-state-item-name">分类</span></a></div> <div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">
        11
      </span> <span class="site-state-item-name">标签</span></a></div></nav> <nav><small>本订阅号已写下 2.08万 字。</small></nav> <!----></div></div></aside> <main id="main"><article class="post"><h1>
      Nuxtpress - Node.js 动态网站静态化之路
    </h1> <div class="meta"><span>字数：1.2千字</span> |
      <span data-date="2018-12-13T04:33:50.000Z" class="date">发表于：2018年12月13日</span></div> <div class="content"><p>相信 Hexo、Ghost、WordPress 等常见的开源内容框架对于很多人来说都不陌生。</p>
<p><img src="https://user-images.githubusercontent.com/1890238/50014695-98cb3e00-ffff-11e8-822e-df2717b27f82.png" alt="1"></p>
<p>看到这张简单的示意图，应该能够发现，传统的网站生成有两种方式：</p>
<ul>
<li>一种是类似于 Hexo，纯静态的，通过 markdown 编辑文章内容，然后执行命令生成静态网站；</li>
<li>另一种是类似于 Ghost，纯动态的，通过管理后台编辑文章（存入数据库，如 MySQL），然后通过渲染器进行渲染，网站内容为动态的，需要在服务器上跑一个服务（程序）。</li>
</ul>
<p>而 WordPress（PHP）之类的框架有一些天然的优势，就是能够很方便地生成出静态页面作为缓存。</p>
<p>当然，这样的方式建站，如企业的官网，显然是很不现代。因此，Node.js SSR（服务器端渲染）登上了历史舞台。然而服务器端渲染的性能瓶颈至今未有一个很好的解决方案（我们现在前端流行的框架基本上都会使用虚拟 Dom 或类似的方案，遍历虚拟 Dom 相较于模板渲染性能相差不是一个数量级）。</p>
<!-- more -->
<p>在个人网站（本站）的实践中，做过了大量的选型和对比（<a href="https://v0.chat/p/hello-world">开篇</a>中有提及），但最终未得到一个令人满意的框架。其中较为心仪的有两个：</p>
<ul>
<li>Nuxtent：作者已经将兴趣转移，所以只是个雏形，但本篇介绍的主角 Nuxtpress 基于该框架的设计思想进行开发。</li>
<li>Vuepress：最初选择用的该框架，但这个框架有些不伦不类，扩展性不高，代码臃肿又难以扩展，所以用了一段时间之后直接就扔掉索性自己重写一个。</li>
</ul>
<h2 id="nuxtpress"><a class="header-anchor" href="#nuxtpress">#</a> Nuxtpress</h2>
<blockquote>
<p>一直都在犹豫“是时候表演一波真正的技术了。”</p>
</blockquote>
<p>来得有点晚，功能也比较简单，扩展性几乎等于没有。但好在，代码质量勉强还保持在A，目前发布的版本 v0.2.0 代码总量大约在 <strong>250</strong> 行左右，项目大小 10kb。</p>
<p>源码地址： <a href="https://github.com/assholev0/nuxtpress">https://github.com/assholev0/nuxtpress</a></p>
<p>苦于精力有限，没有时间花在该项目上，所以前后磨蹭了三个月时间，只憋出了不到 300 行代码。目前满足了我当下静态网站生成的需要。从长远来看，这个框架，我希望它能做得更多。</p>
<p>大概的设计思路如下图：</p>
<p><img src="https://user-images.githubusercontent.com/1890238/50014696-9963d480-ffff-11e8-8cb9-3e14b0ee4a8f.png" alt="2"></p>
<p>分为三种模式：</p>
<ul>
<li>纯静态模式</li>
<li>动态内容/静态网站模式</li>
<li>纯动态模式</li>
</ul>
<p>其中，模式二【<strong>动态内容/静态网站模式</strong>】作为核心功能，重中之重。</p>
<p>将整个框架拆为几部分核心模块：</p>
<ul>
<li>核心模块（Core）
<ul>
<li>所有模式统一的入口，基于 Nuxt Module 封装配置装载器，根据配置项选择加载适配器、工具（触发器、部署）等</li>
</ul>
</li>
<li>适配器（Adapter）
<ul>
<li>内容源的管理适配，如 MySQL、Markdown静态文件等</li>
<li>抛出统一的内容管理接口</li>
</ul>
</li>
<li>工具
<ul>
<li>部署工具（Deployer）： 如将静态网站部署到 Github Pages、阿里云 OSS（CDN）等</li>
<li>触发器工具（Trigger）： 生成 Server Less 服务，如阿里云 API网关 + 函数计算的无服务器后台接口</li>
</ul>
</li>
</ul>
<p>【<strong>动态内容/静态网站模式</strong>】技术难点及实现思路：</p>
<ul>
<li>静态网站如何管理动态内容？
<ul>
<li>特征：管理后台框架固定（如基本的文章管理、分类管理、标签管理等）</li>
<li>前端：打包生成的静态网站中，将管理后台界面直接包含在内</li>
<li>后端动态内容接口：可以通过阿里云函数计算、腾讯云无服务器函数等方式进行部署</li>
</ul>
</li>
<li>打包性能
<ul>
<li>服务器渲染特征：无需打包，渲染性能低，重复开销</li>
<li>静态网站特征：打包效率低，一次性支出</li>
<li>取舍：牺牲打包性能，优化访问性能</li>
<li>待攻克问题： 现有项目打包都是一次性完整打包，所以当网站内容多的时候，打包时间也会呈指数增长</li>
<li>解决思路： 增量打包和定量打包，对于原有旧内容，在打包时进行忽略（<em><strong>可行性需要进一步实践</strong></em>）</li>
</ul>
</li>
</ul>
<h2 id="参与"><a class="header-anchor" href="#参与">#</a> 参与</h2>
<ul>
<li>如果你对贡献这个项目框架感兴趣</li>
<li>如果你对采用该技术架构进行建站感兴趣</li>
<li>如果你对该方向的技术岗位（南京）感兴趣</li>
</ul>
<p>请不要犹豫，关注我的微信公众号并与我取得联系。</p>
</div> <div class="qr"><p>扫码关注不迷路</p> <img src="/qr.png"></div> <div><ul class="post-copyright"><li><strong>本文作者： </strong>Willin Wang
        </li> <li><strong>本文链接：</strong> <a href="https://v0.chat/p/nuxtpress" title="Nuxtpress - Node.js 动态网站静态化之路">https://v0.chat/p/nuxtpress</a></li> <li><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用
          <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a>
          许可协议。转载请注明出处！
        </li></ul></div></article> <footer><p>
    Copyright 2018~2022 ©
    <a href="https://willin.wang" target="_blank">Willin Wang</a></p> <p>
    Github:
    <a href="https://github.com/willin" target="_blank">willin</a> |
    <a href="https://github.com/assholev0" target="_blank">assholev0</a></p> <p><small><a href="http://www.beian.miit.gov.cn" target="_blank">
      苏ICP备19022432号
    </a></small></p></footer></main></div></div></div><script>window.__NUXT__={layout:"default",data:[{info:{title:"初瘦",description:"想当初，也瘦过。",posts:15,tags:11,categories:3,wordcount:20817},post:{content:'<p>相信 Hexo、Ghost、WordPress 等常见的开源内容框架对于很多人来说都不陌生。</p>\n<p><img src="https://user-images.githubusercontent.com/1890238/50014695-98cb3e00-ffff-11e8-822e-df2717b27f82.png" alt="1"></p>\n<p>看到这张简单的示意图，应该能够发现，传统的网站生成有两种方式：</p>\n<ul>\n<li>一种是类似于 Hexo，纯静态的，通过 markdown 编辑文章内容，然后执行命令生成静态网站；</li>\n<li>另一种是类似于 Ghost，纯动态的，通过管理后台编辑文章（存入数据库，如 MySQL），然后通过渲染器进行渲染，网站内容为动态的，需要在服务器上跑一个服务（程序）。</li>\n</ul>\n<p>而 WordPress（PHP）之类的框架有一些天然的优势，就是能够很方便地生成出静态页面作为缓存。</p>\n<p>当然，这样的方式建站，如企业的官网，显然是很不现代。因此，Node.js SSR（服务器端渲染）登上了历史舞台。然而服务器端渲染的性能瓶颈至今未有一个很好的解决方案（我们现在前端流行的框架基本上都会使用虚拟 Dom 或类似的方案，遍历虚拟 Dom 相较于模板渲染性能相差不是一个数量级）。</p>\n\x3c!-- more --\x3e\n<p>在个人网站（本站）的实践中，做过了大量的选型和对比（<a href="https://v0.chat/p/hello-world">开篇</a>中有提及），但最终未得到一个令人满意的框架。其中较为心仪的有两个：</p>\n<ul>\n<li>Nuxtent：作者已经将兴趣转移，所以只是个雏形，但本篇介绍的主角 Nuxtpress 基于该框架的设计思想进行开发。</li>\n<li>Vuepress：最初选择用的该框架，但这个框架有些不伦不类，扩展性不高，代码臃肿又难以扩展，所以用了一段时间之后直接就扔掉索性自己重写一个。</li>\n</ul>\n<h2 id="nuxtpress"><a class="header-anchor" href="#nuxtpress">#</a> Nuxtpress</h2>\n<blockquote>\n<p>一直都在犹豫“是时候表演一波真正的技术了。”</p>\n</blockquote>\n<p>来得有点晚，功能也比较简单，扩展性几乎等于没有。但好在，代码质量勉强还保持在A，目前发布的版本 v0.2.0 代码总量大约在 <strong>250</strong> 行左右，项目大小 10kb。</p>\n<p>源码地址： <a href="https://github.com/assholev0/nuxtpress">https://github.com/assholev0/nuxtpress</a></p>\n<p>苦于精力有限，没有时间花在该项目上，所以前后磨蹭了三个月时间，只憋出了不到 300 行代码。目前满足了我当下静态网站生成的需要。从长远来看，这个框架，我希望它能做得更多。</p>\n<p>大概的设计思路如下图：</p>\n<p><img src="https://user-images.githubusercontent.com/1890238/50014696-9963d480-ffff-11e8-8cb9-3e14b0ee4a8f.png" alt="2"></p>\n<p>分为三种模式：</p>\n<ul>\n<li>纯静态模式</li>\n<li>动态内容/静态网站模式</li>\n<li>纯动态模式</li>\n</ul>\n<p>其中，模式二【<strong>动态内容/静态网站模式</strong>】作为核心功能，重中之重。</p>\n<p>将整个框架拆为几部分核心模块：</p>\n<ul>\n<li>核心模块（Core）\n<ul>\n<li>所有模式统一的入口，基于 Nuxt Module 封装配置装载器，根据配置项选择加载适配器、工具（触发器、部署）等</li>\n</ul>\n</li>\n<li>适配器（Adapter）\n<ul>\n<li>内容源的管理适配，如 MySQL、Markdown静态文件等</li>\n<li>抛出统一的内容管理接口</li>\n</ul>\n</li>\n<li>工具\n<ul>\n<li>部署工具（Deployer）： 如将静态网站部署到 Github Pages、阿里云 OSS（CDN）等</li>\n<li>触发器工具（Trigger）： 生成 Server Less 服务，如阿里云 API网关 + 函数计算的无服务器后台接口</li>\n</ul>\n</li>\n</ul>\n<p>【<strong>动态内容/静态网站模式</strong>】技术难点及实现思路：</p>\n<ul>\n<li>静态网站如何管理动态内容？\n<ul>\n<li>特征：管理后台框架固定（如基本的文章管理、分类管理、标签管理等）</li>\n<li>前端：打包生成的静态网站中，将管理后台界面直接包含在内</li>\n<li>后端动态内容接口：可以通过阿里云函数计算、腾讯云无服务器函数等方式进行部署</li>\n</ul>\n</li>\n<li>打包性能\n<ul>\n<li>服务器渲染特征：无需打包，渲染性能低，重复开销</li>\n<li>静态网站特征：打包效率低，一次性支出</li>\n<li>取舍：牺牲打包性能，优化访问性能</li>\n<li>待攻克问题： 现有项目打包都是一次性完整打包，所以当网站内容多的时候，打包时间也会呈指数增长</li>\n<li>解决思路： 增量打包和定量打包，对于原有旧内容，在打包时进行忽略（<em><strong>可行性需要进一步实践</strong></em>）</li>\n</ul>\n</li>\n</ul>\n<h2 id="参与"><a class="header-anchor" href="#参与">#</a> 参与</h2>\n<ul>\n<li>如果你对贡献这个项目框架感兴趣</li>\n<li>如果你对采用该技术架构进行建站感兴趣</li>\n<li>如果你对该方向的技术岗位（南京）感兴趣</li>\n</ul>\n<p>请不要犹豫，关注我的微信公众号并与我取得联系。</p>\n',wordcount:1174,tags:["创意","nuxt","前端"],category:["技术"],title:"Nuxtpress - Node.js 动态网站静态化之路",date:"2018-12-13T04:33:50.000Z",slug:"nuxtpress"}}],fetch:[],error:null,serverRendered:!0,routePath:"/p/nuxtpress"}</script><script src="/_nuxt/b62c614e63f83c6be00e.js" defer></script><script src="/_nuxt/e11a89e73901e5a987e8.js" defer></script><script src="/_nuxt/6f82558aa98d932751d3.js" defer></script><script src="/_nuxt/1adc803c9f70786e1780.js" defer></script>
  </body>
</html>
